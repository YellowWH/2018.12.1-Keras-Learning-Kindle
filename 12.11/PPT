searchblock_image_shape = Input(shape=(15, 15, 3))
branch_one_pix = layers.Conv2D(128, 3, activation='relu', padding='same')(searchblock_image_shape)
branch_one_pix = layers.Conv2D(128, 3, activation='relu', padding='same')(branch_one_pix)
branch_one_pix = layers.Flatten()(branch_one_pix)

right_image_shape = Input(shape=(3000, 2000, 3))
branch_whole_image = layers.Conv2D(128, 3, activation='relu', padding='same')(right_image_shape)
branch_whole_image = layers.Conv2D(128, 3, activation='relu', padding='same')(branch_whole_image)
branch_whole_image = layers.Conv2D(128, 3, activation='relu', padding='same')(branch_whole_image)
branch_whole_image = layers.Flatten()(branch_whole_image)

concatenate1 = layers.concatenate([branch_one_pix, branch_whole_image], axis=-1)
# disparityL = layers.Flatten()(concatenate1)
disparityL = layers.Dense(4000, activation='relu')(concatenate1)
disparityL = layers.Dense(3000, activation='relu')(disparityL)
disparityL = layers.Dense(2000, activation='relu')(disparityL)
disparityL = layers.Dense(1500, activation='softmax')(disparityL)

model = Model([searchblock_image_shape, right_image_shape], disparityL)
model.summary()
